<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>Kenya KML Example</title>
    <link rel="stylesheet" type="text/css" href="master.css" />
    <link href='http://fonts.googleapis.com/css?family=Droid+Sans:regular,bold' rel='stylesheet' type='text/css'>
   <script src="http://maps.google.com/maps?file=api&v=2&sensor=false&key=ABQIAAAAMZNg41bN521EXFwwh7cujhSpfjEP2QVILgdw8WK32V8c54kxEhTj9YRAas47HINQnOR-2mAByhouIQ"
      type="text/javascript"></script>
    <script type="text/javascript" src="timemap.2.0/lib/jquery-1.5.1.js"></script>
   <script src="Scripts/AC_RunActiveContent.js" type="text/javascript"></script>
	<script type="text/javascript" src="timemap.2.0/lib/jquery.easing.1.3.js"></script>
	   
    <script type="text/javascript" src="timemap.2.0/lib/mxn/mxn.js?(googlev3)"></script>
    <script type="text/javascript" src="timemap.2.0/lib/timeline-1.2.js"></script>
    <script src="timemap.2.0/src/timemap.js" type="text/javascript"></script>
    <script src="timemap.2.0/src/param.js" type="text/javascript"></script>
    <script src="timemap.2.0/src/loaders/xml.js" type="text/javascript"></script>
    <script src="timemap.2.0/src/loaders/kml.js" type="text/javascript"></script>
     <script src="timemap.2.0/src/loaders/georss.js" type="text/javascript"></script>
     
  
     
<script type='text/javascript'>
	//reference to theme url
	var templateURL = "http://crash-box.fr";
	</script>
 <!-- *************MASTER TIMELINE***************     -->  
   <script>
  var tl;

  var zoomLevel = 2;
  var zoomLevelMonths = 2;
  var zoomLevelWeeks = 1;
  var zoomLevelDays = 0;

  var ladate = new Date();
  ladate = ladate.toGMTString();


function onLoad() {
  var eventSource = new Timeline.DefaultEventSource();
  var eventSource1 = new Timeline.DefaultEventSource();
  var eventSource2 = new Timeline.DefaultEventSource();
  var eventSource3 = new Timeline.DefaultEventSource();
  var zoomStepsArray = new Array(
              {pixelsPerInterval: 400,  unit: Timeline.DateTime.DAY},
              //{pixelsPerInterval: 200,  unit: Timeline.DateTime.DAY},
              //{pixelsPerInterval: 100,  unit: Timeline.DateTime.DAY},
              //{pixelsPerInterval:  50,  unit: Timeline.DateTime.DAY},
              //{pixelsPerInterval: 400,  unit: Timeline.DateTime.MONTH},
              //{pixelsPerInterval: 200,  unit: Timeline.DateTime.MONTH},
              {pixelsPerInterval: 400,  unit: Timeline.DateTime.WEEK},
              {pixelsPerInterval: 400,  unit: Timeline.DateTime.MONTH} // DEFAULT zoomIndex
            );
            
   var bandInfos = [
     Timeline.createBandInfo({
	       eventSource:    eventSource3,
          date:           "Jun 28 2011 00:00:00 GMT",
          width:          "70px", 
          intervalUnit:   Timeline.DateTime.MONTH, 
          intervalPixels: 400,
		      zoomIndex:      zoomLevel,
          zoomSteps:      zoomStepsArray
		 
     }),
	  Timeline.createBandInfo({
	 eventSource:    eventSource2,
          date:           "Jun 28 2011 00:00:00 GMT",
          width:          "70px", 
          intervalUnit:   Timeline.DateTime.MONTH, 
          intervalPixels: 400,
		      zoomIndex:      zoomLevel,
          zoomSteps:      zoomStepsArray
     }),
	  Timeline.createBandInfo({
	        eventSource:    eventSource1,
          date:           "Jun 28 2011 00:00:00 GMT",
          width:          "70px", 
          intervalUnit:   Timeline.DateTime.MONTH, 
          intervalPixels: 400,
		      zoomIndex:      zoomLevel,
          zoomSteps:      zoomStepsArray
     }),
	 Timeline.createBandInfo({
	        eventSource:    eventSource,
          date:           "Jun 28 2011 00:00:00 GMT",
          width:          "70px", 
          intervalUnit:   Timeline.DateTime.MONTH, 
          intervalPixels: 400,
		      zoomIndex:      zoomLevel,
          zoomSteps:      zoomStepsArray
     }),
     Timeline.createBandInfo({
	     /* eventSource:    eventSource,*/
          date:           "Jun 28 2011 00:00:00 GMT",
          width:          "30px", 
          intervalUnit:   Timeline.DateTime.MONTH, 
          intervalPixels: 600,
		      zoomIndex:      zoomLevel,
          zoomSteps:      zoomStepsArray		 
     }),	 
	  Timeline.createBandInfo({
	     /* eventSource:    eventSource,*/
          date:           "Jun 28 2011 00:00:00 GMT",
           width:          "100px", 
          intervalUnit:   Timeline.DateTime.MONTH, 
          intervalPixels: 400
     }),
	  Timeline.createBandInfo({
	        eventSource:    eventSource3,    
          date:           "Jun 28 2011 00:00:00 GMT",
          width:          "50px", 
          intervalUnit:   Timeline.DateTime.MONTH, 
          intervalPixels: 400,
		      zoomIndex:      zoomLevel,
          zoomSteps:      zoomStepsArray
     }),
   ];
    var tomorrow = new Date();
    tomorrow.setTime(tomorrow.getTime() + (1000 * 3600 * 24));
<!--   ********TEST SETTING A COLOR BAND FOR DATE *************-->
   for (var i = 0; i < bandInfos.length; i++) {
      if (i != 4) {
         bandInfos[i].syncWith = 4;
          bandInfos[i].highlight = true;   
      }
      if (i != 5) {
				  bandInfos[i].highlight = true;
                bandInfos[i].decorators = [
                    new Timeline.SpanHighlightDecorator({
                        startDate:  ladate,
                        endDate:    tomorrow,
                        color:      "#FF0000",
                        opacity:    ((i != 4) ? 10 : 100),
                        startLabel: "",
                        endLabel:   ((i != 4) ? "" : ""),
                       // theme:      theme,
                       cssClass: 't-highlight1'
                    }),
                  /*  new Timeline.PointHighlightDecorator({
                        date:       "Tues Apr 5 2011 14:38:00 GMT-0600",
                        color:      "#FFC080",
                        opacity:    50,
                        //theme:      theme,
                        cssClass: 'p-highlight1'
                    }),
                    new Timeline.PointHighlightDecorator({
                        date:       "Tues Apr 5 2011 13:00:00 GMT-0600",
                        color:      "#FFC080",
                        opacity:    50
                        //theme:      theme
                    })*/
                ]; }
            }
   
			
			<!--   ********END TEST SETTING A COLOR BAND FOR DATE *************-->
    tl = Timeline.create(document.getElementById("my-timeline"), bandInfos);
    Timeline.loadXML("http://crash-box.fr/index.php?feed=timeline&cat=26", function(xml, url) { eventSource.loadXML(xml, url); });
    Timeline.loadXML("http://crash-box.fr/index.php?feed=timeline&cat=4", function(xml, url) { eventSource1.loadXML(xml, url); });
    Timeline.loadXML("http://crash-box.fr/index.php?feed=timeline&cat=19", function(xml, url) { eventSource2.loadXML(xml, url); });
    Timeline.loadXML("http://crash-box.fr/index.php?feed=timeline&cat=20", function(xml, url) { eventSource3.loadXML(xml, url); });

    tl.getBand(1).setCenterVisibleDate(Timeline.DateTime.parseGregorianDateTime(ladate));
 }
 var resizeTimerID = null;
 function onResize() {
     if (resizeTimerID == null) {
         resizeTimerID = window.setTimeout(function() {
             resizeTimerID = null;
             tl.layout();
         }, 500);
     }
 }
</script>
<!--   ***************END MASTER TIMELINE****************-->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
<!--
body {
	margin-top: 0px;
	margin-left: 0px;
	margin-right: 0px;
}
-->
</style>

<!--************CODE FOR MAP AND TIMELINE******************      -->
    <script type="text/javascript">
                                       
function zoomTo(zoomNeeded) {
      var rtrndate = tl.getBand(1).getCenterVisibleDate();
      var zoomBool = (zoomLevel > zoomNeeded) ? true : false;
      
      while (zoomLevel != zoomNeeded) {
        for (var i = 0; i < 7; i++) {
          tl.getBand(i).zoom(zoomBool);
        }
        zoomLevel = ((zoomLevel > zoomNeeded) ? zoomLevel - 1 : zoomLevel + 1);
      }
      for (var i = 0; i < 7; i++) {
        tl.getBand(i).paint();
      }
      tl.getBand(1).setCenterVisibleDate(rtrndate);
}
function zoomToMonths() {
  zoomTo(zoomLevelMonths);
}
function zoomToWeeks() {
  zoomTo(zoomLevelWeeks);
}
function zoomToDays() {
  zoomTo(zoomLevelDays);
}                             
function zoomToToday() {
  tl.getBand(1).setCenterVisibleDate(Timeline.DateTime.parseGregorianDateTime(ladate));
}

function slideToLeft() {
/* REMINDER: Use getMinVisible and getMaxVisible to move by dynamic screen size instead*/
    var rtrntime = tl.getBand(1).getCenterVisibleDate();
    if (zoomLevel == zoomLevelMonths) {
      rtrntime.setTime(rtrntime.getTime() - ((1000 * 3600 * 24) * 30));
    } else if (zoomLevel == zoomLevelWeeks) {
      rtrntime.setTime(rtrntime.getTime() - ((1000 * 3600 * 24) * 7));
    } else if (zoomLevel == zoomLevelDays) {
      rtrntime.setTime(rtrntime.getTime() - ((1000 * 3600 * 24) * 1));
    };
    tl.getBand(1).setCenterVisibleDate(Timeline.DateTime.parseGregorianDateTime(rtrntime));
}

function slideToRight() {
    var rtrntime = tl.getBand(1).getCenterVisibleDate();
    if (zoomLevel == zoomLevelMonths) {
      rtrntime.setTime(rtrntime.getTime() + ((1000 * 3600 * 24) * 30));
    } else if (zoomLevel == zoomLevelWeeks) {3
      rtrntime.setTime(rtrntime.getTime() + ((1000 * 3600 * 24) * 7));
    } else if (zoomLevel == zoomLevelDays) {
      rtrntime.setTime(rtrntime.getTime() + ((1000 * 3600 * 24) * 1));
    };
    tl.getBand(1).setCenterVisibleDate(Timeline.DateTime.parseGregorianDateTime(rtrntime));
}

var tm;
$(function() {
 
    // make a custom map style
    var styledMapType = new google.maps.StyledMapType([
        {
            featureType: "water",
            elementType: "all",
			
            stylers: [
              { saturation: 0 },
              { lightness: 100 }
            ]
        },
        {
            featureType: "all",
            elementType: "all",
            stylers: [
              { saturation: -90 }
            ]
        }
    ], {
        name: "white"
    });
	//SET UP CUSTOM ICON FOR MAP
/*var customIcon = new google.maps.Marker({
		
		icon: templateURL+"/customicons/marker.png"
	})		*/
    tm = TimeMap.init({
        mapId: "map",               // Id of map div element (required)
        timelineId: "my-timeline",     // Id of timeline div element (required)
        options: {
		/*mapType: "satellite",*/
			/*showMapCtrl: false,*/
			/*mapCenter: new google.maps.LatLng(33,65),*/
			/*mapZoom: 5,
			icon: customIcon*/
			/*eventIconImage: "tm-timeline-event-but.png",
			eventIconPath: templateURL+"/images/"*/
        },
       datasets: [
            {
                title: "Recent Earthquakes",
                theme: "red",
                type: "georss", // Data to be loaded in GeoRSS - must be a local URL
                options: { 
                    // GeoRSS file to load
					
                    url: "index.php?feed=georss&cat=20",
                    // additional tags to load
                    extraTags: ['link'],
                    // custom template to use the extra data
                    infoTemplate: '<div class="infotitle"><a href="{{link}}">{{title}}</a></div>' + 
                                  '<div class="infodescription">{{description}}</div>'
                }
           
		   
		    }
        ],

       /* bandIntervals: [
            Timeline.DateTime.DECADE, 
            Timeline.DateTime.CENTURY
        ]*/
    });		
   // set the map to our custom style
    var gmap = tm.getNativeMap();
    gmap.mapTypes.set("white", styledMapType);
    gmap.setMapTypeId("white");

});

	

    </script>
<!--<link href="slidingsite/examples/examples.css" type="text/css" rel="stylesheet"/>-->
  </head>

  <body onLoad="onLoad();" onResize="onResize();">
  
<!-- **************SLIDING BACKGROUND CONTENT*********************-->
    <div id="header">
   		<div id="headercontrols">
   			 <button id="go1">&raquo; BACKGROUND</button><button id="go2">&raquo; HIDE</button>
   		 </div>
    </div>


<!-- **************END SLIDING BACKGROUND CONTENT*********************-->

<!-- **************COMBINED TIMELINE+MAP*********************-->
<div id="timebox">
    
       <div id="countdown">
       <div id="timer"><img src="gfx/testlogo.png" alt="" /></div>
       <div id="controls"><button id="go5">&raquo; TIMEMAP</button>
<button id="go6">&raquo; TIMEMAPDOWN</button></div>
       </div>
    
    
        <div id="timelinecontainer">
       
         
          <div id="my-timeline"></div>
          
         
        </div>
        
        <div id="mapcontainer">
          <div id="map"></div>
        </div>
      </div>
<!-- **************END COMBINED TIMELINE+MAP*********************  -->

<!--
 **************SLIDING FOOTER+CREDITS*********************    -->  
         <div id="footer">
   <button id="go3">&raquo; CREDITS</button>
   <button id="go4">&raquo; HIDE</button>
   </div>
    
<!--  **************SLIDING FOOTER+CREDITS*********************    -->    
  
<!--  **************SLIDING PANEL JAVASCRIPTS*********************        -->
    <script>




/**********MAIN PANEL ANIM**************/
/**********HEADER**************/
$( "#go1" ).click(function(){
  $( "#header" ).animate({ top: "0px" }, 500 )
  .animate({ height: "50%" }, 500 )
   $( "#timebox" ).animate({ top: "300px" }, 500 )

});

$( "#go2" ).click(function(){
  $( "#header" ).animate({ top: "-370px" }, 500 )
    .animate({ height: "400px" }, 500 )
 $( "#timebox" ).animate({ top: "30px" }, 500 )
});


/**********FOOTER**************/
$( "#go3" ).click(function(){
  $( "#footer" ).animate({ bottom: "0px" }, 500 )
   .animate({ height: "50%" }, 1000 )
 $( "#timebox" ).animate({ top: "30px" }, 500 )
});


$( "#go4" ).click(function(){
  $( "#footer" ).animate({ bottom: "-270px" }, 500 )
   .animate({ height: "300px" }, 500 )
 $( "#timebox" ).animate({ top: "30px" }, 500 )
});


/**********TIMELINE/MAP**************/

$( "#go5" ).click(function(){
  $( "#timebox" ).animate({ top: "-220px" }, 500 )

});





$( "#go6" ).click(function(){
  $( "#timebox" ).animate({ top: "30px" }, 500 )

});
/**********MAIN ANIM end**************/


</script>

 <!--   **************SLIDING PANEL JAVASCRIPTS*********************    --> 
    
  </body>
</html>
